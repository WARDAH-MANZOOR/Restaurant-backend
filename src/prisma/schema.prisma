datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum UserRole {
  ADMIN
  RESTAURANT
  HOME_BASED_RESTAURANT
  CUSTOMER
}

model User {
  uid            String    @default(uuid())
  user_id         Int       @id @default(autoincrement())
  email         String    @unique
  password      String
  role          UserRole  @default(CUSTOMER)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  adminProfile        AdminProfile?
  restaurantProfile   RestaurantProfile?
  homeBasedRestaurant HomeBasedRestaurant?
  customerProfile     CustomerProfile?
}

model AdminProfile {
  id      String @id @default(uuid())
  userId  Int  @unique
  user    User   @relation(fields: [userId], references: [user_id])
}

model RestaurantProfile {
  id          Int    @id @default(autoincrement())
  userId      Int    @unique
  user        User      @relation(fields: [userId], references: [user_id])
  name        String
  cuisineType String[]
  ownerName   String
  ownerPhone  String
  isApproved  Boolean   @default(false)
  orders      Order[]
}

model HomeBasedRestaurant {
  id          Int    @id @default(autoincrement())
  userId      Int     @unique
  user        User      @relation(fields: [userId], references: [user_id])
  name        String
  cuisineType String[]
  ownerName   String
  ownerPhone  String
  isApproved  Boolean   @default(false)
  orders      Order[]
}

model CustomerProfile {
  id          Int    @id @default(autoincrement())
  userId      Int @unique
  user      User    @relation(fields: [userId], references: [user_id])
  name        String
  phone     String
  address   String
  orders    Order[]
}

model Order {
  id          Int    @id @default(autoincrement())
  customerId    Int @unique
  customer      CustomerProfile @relation(fields: [customerId], references: [id])
  restaurantId  Int? @unique
  restaurant    RestaurantProfile? @relation(fields: [restaurantId], references: [id])
  homeBasedRestaurantId Int? @unique
  homeBasedRestaurant HomeBasedRestaurant? @relation(fields: [homeBasedRestaurantId], references: [id])
  totalAmount   Float
  commission    Float
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}
